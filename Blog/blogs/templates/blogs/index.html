{% extends "blogs/base.html" %}

{% block content %}
  <h2 class="text-center mb-4 text-primary">最新博文</h2>

  {% for post in posts %}
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h3 class="card-title">{{ post.title }}</h3>
        <p class="text-muted" style="font-size: 0.8rem;">
          作者: {{ post.owner }} | 发布于: {{ post.date_added|date:"Y-m-d H:i" }}
        </p>
        
        {% if post.image %}
          <div class="text-center mb-3">
            <img src="{{ post.image.url }}" class="img-fluid rounded" style="max-height: 400px;">
          </div>
        {% endif %}
        
        <p class="card-text">{{ post.content|linebreaks }}</p>

        <div class="mt-3 border-top pt-2 text-end">
          {% if post.owner == user or user.is_superuser %}
            <a href="{% url 'blogs:edit_post' post.id %}" class="btn btn-outline-primary btn-sm me-2">编辑</a>
            
            <a href="{% url 'blogs:delete_post' post.id %}" 
               class="btn btn-outline-danger btn-sm"
               onclick="return confirm('警告：确定要永久删除这篇博文吗？');">
               删除
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  {% empty %}
    <p class="text-center">目前还没有博文。</p>
  {% endfor %}

{% endblock content %}